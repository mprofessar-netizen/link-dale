<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verification</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #000000;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            padding: 10px;
            text-align: center;
        }

        /* Fake Video Player Box */
        #ad-player-box {
            width: 100%;
            max-width: 400px;
            height: 250px;
            background-color: #111;
            border: 2px solid #333;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 25px;
            position: relative;
            background-image: url('https://img.icons8.com/ios-filled/100/444444/video.png'); 
            background-repeat: no-repeat;
            background-position: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #play-btn {
            background-color: #ff0000;
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.6);
            animation: pulse 1.5s infinite;
            z-index: 2;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Timer Box */
        #timer-box {
            display: none;
            font-size: 22px;
            font-weight: bold;
            color: #ffcc00;
            margin-bottom: 20px;
            padding: 15px;
            background: #222;
            border-radius: 10px;
            border: 1px solid #444;
            width: 90%;
            max-width: 350px;
        }

        /* Warning Text */
        .warning-text {
            color: #ff4444;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }

        /* Input Section */
        #input-section {
            display: none;
            width: 100%;
            max-width: 400px;
        }

        input {
            width: 80%;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #444;
            background: #222;
            color: white;
            margin-bottom: 15px;
            font-size: 16px;
            outline: none;
            text-align: center;
        }

        button.submit-btn {
            background-color: #2481cc;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            width: 90%;
        }

        .status-text {
            color: #aaa;
            margin-top: 10px;
            font-size: 14px;
        }
    </style>
</head>
<body>

    <div id="ad-player-box" onclick="startAdFlow()">
        <button id="play-btn">‚ñ∂Ô∏è Play Video</button>
        <p class="status-text" id="status-msg">Click to Watch Ad & Verify</p>
    </div>

    <div id="timer-box">
        ‚è≥ Timer: <span id="time">30</span>s
        <div id="warning-msg" class="warning-text">‚ö†Ô∏è Go back to Ad page to continue timer!</div>
    </div>

    <div id="input-section">
        <h3 style="color: #4CAF50;">‚úÖ Verified!</h3>
        <input type="text" id="userLink" placeholder="Paste Telegram Link here...">
        <br>
        <button class="submit-btn" onclick="submitLink()">üöÄ Submit Link</button>
    </div>

    <script>
        // --- CONFIGURATION ---
        const BOT_USERNAME = "Baymaxl_bot"; 
        const ADSTERRA_LINK = "https://www.effectivegatecpm.com/dhgty15yfe?key=68374b26e438b0e7cca7ba36137eafd2";

        // Elements
        const playerBox = document.getElementById("ad-player-box");
        const playBtn = document.getElementById("play-btn");
        const statusMsg = document.getElementById("status-msg");
        const timerBox = document.getElementById("timer-box");
        const timeSpan = document.getElementById("time");
        const warningMsg = document.getElementById("warning-msg");
        const inputSection = document.getElementById("input-section");

        let isAdStarted = false;
        let timeLeft = 30;
        let timerInterval;

        function startAdFlow() {
            if (isAdStarted) return;
            isAdStarted = true;

            // Open Adsterra
            window.open(ADSTERRA_LINK, '_blank');

            // UI Changes
            playBtn.style.display = "none";
            statusMsg.innerText = "Checking Ad View...";
            playerBox.style.opacity = "0.3";
            playerBox.style.pointerEvents = "none";
            timerBox.style.display = "block";

            // Start Anti-Cheat Timer
            startSmartTimer();
        }

        function startSmartTimer() {
            timerInterval = setInterval(() => {
                // LOGIC: Agar User is page par dekh raha hai (document.hidden is false)
                // To timer mat chalao. Agar user dusre tab (Ad) par hai (document.hidden is true)
                // To timer chalao.
                
                // Note: Mobile browsers me behavior thoda alag hota hai, 
                // isliye hum simplified "Focus Check" use karenge.
                
                // Simple Logic: Timer runs ALWAYS, but if user is HERE, we warn them.
                // Wait, user wants strictness.
                
                // STRICT MODE LOGIC:
                if (document.hidden) {
                    // User is on AD tab (Good)
                    timeLeft--;
                    timeSpan.innerText = timeLeft;
                    // Warning hatao
                    warningMsg.style.display = "none";
                    timerBox.style.borderColor = "#ffcc00";
                } else {
                    // User is on THIS tab (Bad - Cheating)
                    // Don't decrease time
                    warningMsg.style.display = "block";
                    warningMsg.innerText = "‚ùå Don't close Ad! Go back to Ad tab!";
                    timerBox.style.borderColor = "red";
                }

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timerBox.style.display = "none";
                    playerBox.style.display = "none";
                    inputSection.style.display = "block";
                }
            }, 1000);
        }

        function submitLink() {
            let link = document.getElementById("userLink").value;
            if (!link || link.length < 3) {
                alert("Please paste a link first!");
                return;
            }
            let cleanLink = link.replace("https://t.me/", "").replace("@", "");
            const tg = window.Telegram.WebApp;
            tg.openTelegramLink(`https://t.me/${BOT_USERNAME}?start=${cleanLink}`);
            tg.close();
        }

        window.Telegram.WebApp.expand();
    </script>

</body>
</html>
